name: Execute Python Scripts on New Theme-YML Files

on:
  workflow_dispatch:
  push:
    paths:
      - 'theme-yml/*'

jobs:
  build:
    runs-on: ubuntu-20.04
    steps:

    - name: Checkout code
      uses: actions/checkout@v2

    - name: Update ubuntu
      run: |
        apt-get -qq update
        echo 🏅

    - name: Install git
      run: |
        apt-get install git -y > /dev/null 2>&1
        echo 🏅

    - name: Install python3
      run: |
        apt-get install python3 -y > /dev/null 2>&1
        echo 🏅

    - name: Install pip3
      run: |
        apt-get install -y python3-pip > /dev/null 2>&1
        echo 🏅

    - name: Python3 requirements.txt
      run: |
        pip3 install -r requirements.txt > /dev/null 2>&1
        echo 🏅

    - name: Generate json
      run: |
        python3 tools/generatJson.py
        echo 🏅

    - name: Generate Installers
      run: |
        python3 tools/generateShFiles.py
        echo 🏅

    - name: Git commit
      run: |
        git config user.name  github-actions[bot]
        git config user.email github-actions[bot]@github.com
        git add .
        git commit -m "------- Generate Themes -------"
        git push